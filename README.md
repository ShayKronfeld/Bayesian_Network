# Bayesian Network Inference Algorithms

## 📌 Project Overview

This project implements **inference algorithms** for Bayesian Networks.  
It supports answering both joint and conditional probability queries using three methods:

1. **Simple Inference (Algo 1)** – Brute-force enumeration of all variable assignments.
2. **Variable Elimination (Algo 2)** – Eliminates hidden variables using factor multiplication and summation.
3. **Heuristic Variable Elimination (Algo 3)** – An optimized version of VE that selects variables for elimination using a smart heuristic.

---

## 📂 Main Files

- `Ex1.java` – Main class that runs the program and handles input/output.
- `Parser.java` – Parses the XML file that defines the Bayesian Network and the query input file.
- `Variable.java` – Represents a variable in the network (name, outcomes, parents, CPT).
- `BayesianNetwork.java` – Stores the network and provides utility methods.
- `SimpleInference.java` – Implements Algorithm 1.
- `VariableElimination.java` – Implements Algorithm 2.
- `HeuristicVariableElimination.java` – Implements Algorithm 3 (with heuristics).
- `Factor.java` – Handles factor operations like join, restrict, sum-out.
- `InferenceAlgorithm.java` – A common interface for all algorithms.
- `input.txt` – Query input file.
- `output.txt` – Output file (generated by the program).

---

## ▶️ How to Run

1. Make sure `input.txt` and the XML network file are in the same directory.
2. In `input.txt`:
   - The **first line** is the name of the XML file.
   - Each **next line** is a query. Example:
     ```
     P(B=T | J=T, M=T),3
     P(A=F, B=F, C=T),1
     ```
     The number at the end indicates which algorithm to use: 1, 2, or 3.

3. Run the `Ex1` class. The output will be saved in `output.txt`, formatted as: probability,additions,multiplications


---

## 🧠 Heuristic Logic in Algorithm 3

When eliminating a hidden variable, the algorithm selects the "best" one by:

1. Finding all factors that include the variable.
2. Gathering all other variables involved in those factors.
3. Estimating the size of the new factor by multiplying the domain sizes of those variables.
4. Selecting the variable with the **smallest estimated factor size**.

If there's a tie, the algorithm breaks it in this order:

- Fewer participating factors.
- Smaller max factor size it appears in.
- Lower ASCII sum of its name.
- Lexicographic order (standard alphabetical order).

This strategy helps reduce the number of operations and keeps intermediate factors small.

---

## 🧪 Example Output

0.28417,7,16

Means: probability = 0.28417, with 7 additions and 16 multiplications performed.

---

## 👤 Author

This project was written as part of an Artificial Intelligence Algorithms course, implementing advanced inference techniques over Bayesian Networks.


